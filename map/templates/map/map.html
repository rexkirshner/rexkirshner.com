{% extends 'base.html' %}

{% block css %}
    <link href="/static/map/map.css" rel="stylesheet">
{% endblock %}


{% block javascript %}
    <script src='https://maps.googleapis.com/maps/api/js?key=AIzaSyBN4BYI6eqF2WlQE2HVbHkSP_Ldu6USWZw&sensor=true'></script>
    <script type="text/javascript">
        function initialize() {
            var mapOptions = {
                center: new google.maps.LatLng(39.8282, -98.5795),
                zoom: 4,
                scrollwheel: false,
            };
            var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
            var ctaLayer = new google.maps.KmlLayer({
                url: 'http://rexkirshnercom.appspot.com/api/location_history.kml',
                preserveViewport: true,
            });
            ctaLayer.setMap(map);
        }
        google.maps.event.addDomListener(window, 'load', initialize);
        $(function() {
            $( "#start_date" ).datepicker();
            $( "#end_date" ).datepicker();
            today = new Date();
            $( "#end_date" ).val( today.getMonth() + '/' + today.getDay() + '/' + today.getFullYear());
        });
        
        $(function() {
            $("#submit_update").click(function() {
                var start = new Date($('#start_date').val()).getTime();
                var end = new Date($('#end_date').val()).getTime();
                var layovers = $('#layovers').is(':checked');
                
                $.ajax({
                  type: "GET",
                  url: "api/settings",
                  data: 'start=' + start + '&end=' + end + '&layovers=' + ,
                  success: function() {
                    $('#contact_form').html("<div id='message'></div>");
                    $('#message').html("<h2>Contact Form Submitted!</h2>")
                    .append("<p>We will be in touch soon.</p>")
                    .hide()
                    .fadeIn(1500, function() {
                      $('#message').append("<img id='checkmark' src='images/check.png' />");
                    });
                  }
                });
                
            });
        });
        
        
        
        
        
        
    </script>
{% endblock %}


{% block content %}
    <div class="panel panel-default map-panel">
        <div class="panel-header">
            <form class="form-inline" role="form">
              <div class="form-group">
              <label>
                <input type="text" class="form-control" id="start_date" value='04/29/2013'>
              </label>
              </div>
              <div class="form-group">
                <label>
                <input type="text" class="form-control" id="end_date">
                </label>
              </div>
                <label>
                  <input type="checkbox" id='layovers'> Show Layovers
                </label>
              <button class="btn btn-default" id='submit_update'>Update</button>
            </form>
        </div>
        
        <div class="panel-body" id="map-canvas">
            Panel content
        </div>
      
    </div>
{% endblock %}